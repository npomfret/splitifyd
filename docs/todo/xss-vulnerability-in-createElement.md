# Potential XSS Vulnerability in `createElement`

## Problem
- **Location**: `webapp/src/js/utils/dom.ts`
- **Description**: The `createElement` function is not safe from Cross-Site Scripting (XSS) attacks. It iterates over the `attributes` object and sets properties on the newly created element. If the `attributes` object contains malicious values (e.g., `innerHTML: '<img src=x onerror=alert(1)>'`), this can lead to the execution of arbitrary JavaScript code.
- **Current vs Expected**: Currently, the function blindly sets properties on the element. It should be updated to only set a limited set of safe attributes and properties, and to properly sanitize any user-provided content.

## Solution
- **Approach**: Create a new, safer function called `createElementSafe`. This function should have a whitelist of safe attributes and properties that can be set. Any other attributes should be ignored or sanitized. For properties that accept HTML content (like `innerHTML`), the content should be sanitized using a library like `DOMPurify`.
- **Code Sample**:
  ```typescript
  import DOMPurify from 'dompurify';

  const SAFE_ATTRIBUTES = ['id', 'class', 'style', 'src', 'href', 'alt', 'title'];

  export function createElementSafe<K extends keyof HTMLElementTagNameMap>(
    tagName: K,
    attributes: Partial<HTMLElementTagNameMap[K]> & { [key: string]: any } = {}
  ): HTMLElementTagNameMap[K] {
    const element = document.createElement(tagName);
    for (const key in attributes) {
      if (SAFE_ATTRIBUTES.includes(key)) {
        element.setAttribute(key, attributes[key]);
      } else if (key === 'textContent') {
        element.textContent = attributes[key];
      } else if (key === 'innerHTML') {
        element.innerHTML = DOMPurify.sanitize(attributes[key]);
      }
    }
    return element;
  }
  ```

## Impact
- **Type**: Behavior change
- **Risk**: Medium (requires careful implementation and testing)
- **Complexity**: Moderate
- **Benefit**: High value (improves security and prevents XSS vulnerabilities)

## Implementation Notes
This is a critical security issue that should be addressed with high priority. After creating the `createElementSafe` function, all existing calls to `createElement` should be reviewed and replaced with the new, safer function. The `dompurify` library will need to be added as a dependency.